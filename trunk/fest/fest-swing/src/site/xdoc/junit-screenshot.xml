<?xml version="1.0" encoding="UTF-8"?>
<document>

  <properties>
    <title>Taking Screenshots of JUnit Failed Tests</title>
  </properties>

  <body>
    <section name="Taking Screenshots of JUnit Failed Tests">
      <p>
        FEST-Swing can take screenshots of the desktop when a <a href="http://www.junit.org" target="_blank">JUnit</a> 
        GUI test fails, either when running tests using Ant or inside an IDE (e.g. 
        <a href="http://www.eclipse.org" target="_blank">Eclipse</a>.)
      </p>
      <p>
        To take screenshots of failed GUI tests, regardless of how they are executed, please follow these steps:
        <ol>
          <li>
            Add the FEST JUnit Extension to your classpath (file fest-swing-junit-{VERSION}.jar, included when you
            download FEST-Swing)
          </li>
          <li>
            Mark GUI tests (class or method level) with the annotation <code class="code">org.fest.swing.annotation.GUITest</code>
          </li>
        </ol>
      </p>
      <p>
        FEST-Swing JUnit extension requires JUnit 4.3.1.
      </p>
      <subsection name="Running GUI tests with Ant">
        <p>
          In order to take screenshots of failed GUI tests with <a href="http://ant.apache.org" target="_blank">Ant</a>
          please follow these steps:
          <ol>
            <li>Add a definition of the Ant task <code class="code">festreport</code></li>
            <li>Use the formatter <code class="code">org.fest.swing.junit.ant.ScreenshotOnFailureResultFormatter</code> 
            inside the junit Ant task</li>
            <li>Use the Ant task <code class="code">festreport</code> instead of <code class="code">junitreport</code>, 
            and specify in its classpath where the fest-swing-junit-{VERSION}.jar file is.</li>            
          </ol>
        </p>
        <p>
          Example:
          <pre class="prettyprint">
  &lt;target name=&quot;test&quot; depends=&quot;compile&quot;&gt;
    <strong>&lt;taskdef resource=&quot;festjunittasks&quot; classpathref=&quot;lib.classpath&quot; /&gt;</strong>
    
    &lt;junit forkmode=&quot;perBatch&quot; printsummary=&quot;yes&quot; haltonfailure=&quot;no&quot; haltonerror=&quot;no&quot;&gt;
      &lt;classpath refid=&quot;lib.classpath&quot; /&gt;
      &lt;classpath location=&quot;${target.test.classes.dir}&quot; /&gt;
      &lt;classpath location=&quot;${target.classes.dir}&quot; /&gt;
      <strong>&lt;formatter classname=&quot;org.fest.swing.junit.ant.ScreenshotOnFailureResultFormatter&quot; extension=&quot;.xml&quot; /&gt;</strong>
      &lt;batchtest fork=&quot;yes&quot; todir=&quot;${target.junit.results.dir}&quot;&gt;
        &lt;fileset dir=&quot;${target.test.classes.dir}&quot; includes=&quot;**/*Test*.class&quot; /&gt;
      &lt;/batchtest&gt;
    &lt;/junit&gt;
    
    <strong>&lt;festreport</strong> todir=&quot;${target.junit.report.dir}&quot;&gt;
      <strong>&lt;classpath refid=&quot;lib.classpath&quot; /&gt;</strong>
      &lt;fileset dir=&quot;${target.junit.results.dir}&quot;&gt;
        &lt;include name=&quot;TEST-*.xml&quot; /&gt;
      &lt;/fileset&gt;
      &lt;report format=&quot;frames&quot; todir=&quot;${target.junit.report.dir}/html&quot; /&gt;
    &lt;/festreport&gt;
  &lt;/target&gt;</pre>          
        </p>
        <p>
          The following is a screenshot of a JUnit HTML report:
        </p>        
        <p>
          <center>
            <img src="./images/junit-ext.jpg" border="0" />
          </center>
        </p>
        <p>
          The Ant task <code class="code">festreport</code> works exactly as <code class="code">junitreport</code>, it 
          can generate HTML reports with or without frames.
        </p>
        <p>
          The Ant task has been tested with Ant 1.7 and requires 
          <a href="http://commons.apache.org/codec/" target="_blank">Apache-Commons Codec 1.3</a>.
        </p>
      </subsection>
      <subsection name="Running GUI tests in an IDE">
        <p>
          FEST-Swing also provides a custom JUnit Runner, <code class="code">org.fest.swing.junit.GUITestRunner</code>,
          which takes screenshots of failed GUI tests. To use it, just annotate your test class with 
          &quot;<code class="code">@RunWith(GUITestRunner.class)</code>.&quot; Screenshots of failed tests will be saved
          in the directory &quot;failed-gui-tests&quot; (relative to the directory where tests are executed.)
        </p>
        <p>
          <code class="code">GUITestRunner</code> has been tested with Eclipse 3.1.1. It is currently not working with
          IntelliJ IDEA due to bug <a href="http://www.jetbrains.net/jira/browse/IDEA-13389" target="_blank">IDEA-13389</a>.
        </p>
      </subsection>
    </section>
  </body>
</document>  
